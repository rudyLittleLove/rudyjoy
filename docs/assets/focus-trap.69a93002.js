import{l as re,n as ce,d as Z,s as K,o as ae,q as ue,b1 as ie,C as le,I as m,j as g,O as B,aj as D,z as de,K as I,e as y,a6 as fe,a7 as j,H as pe}from"./index.b16c7db2.js";import{_ as ee,g as ve}from"./index.78b0e0f0.js";import{f as Ee}from"./index.b8ef152f.js";import{g as te,E as ne}from"./event.635b5201.js";const me=re({to:{type:ce([String,Object]),required:!0},disabled:Boolean}),Te=Z({__name:"teleport",props:me,setup(e){return(n,t)=>n.disabled?K(n.$slots,"default",{key:0}):(ae(),ue(ie,{key:1,to:n.to},[K(n.$slots,"default")],8,["to"]))}});var he=ee(Te,[["__file","/home/runner/work/element-plus/element-plus/packages/components/teleport/src/teleport.vue"]]);const He=le(he),we=(e,n)=>{if(!m)return!1;const t={undefined:"overflow",true:"overflow-y",false:"overflow-x"}[String(n)],s=ve(e,t);return["scroll","auto","overlay"].some(r=>s.includes(r))},$e=(e,n)=>{if(!m)return;let t=e;for(;t;){if([window,document,document.documentElement].includes(t))return window;if(we(t,n))return t;t=t.parentNode}return t};let F;const Ve=e=>{var n;if(!m)return 0;if(F!==void 0)return F;const t=document.createElement("div");t.className=`${e}-scrollbar__wrap`,t.style.visibility="hidden",t.style.width="100px",t.style.position="absolute",t.style.top="-9999px",document.body.appendChild(t);const s=t.offsetWidth;t.style.overflow="scroll";const r=document.createElement("div");r.style.width="100%",t.appendChild(r);const a=r.offsetWidth;return(n=t.parentNode)==null||n.removeChild(t),F=s-a,F};function We(e,n){if(!m)return;if(!n){e.scrollTop=0;return}const t=[];let s=n.offsetParent;for(;s!==null&&e!==s&&e.contains(s);)t.push(s),s=s.offsetParent;const r=n.offsetTop+t.reduce((T,h)=>T+h.offsetTop,0),a=r+n.offsetHeight,d=e.scrollTop,v=d+e.clientHeight;r<d?e.scrollTop=r:a>v&&(e.scrollTop=a-e.clientHeight)}const A="focus-trap.focus-after-trapped",U="focus-trap.focus-after-released",ye="focus-trap.focusout-prevented",q={cancelable:!0,bubbles:!1},Fe={cancelable:!0,bubbles:!1},M="focusAfterTrapped",z="focusAfterReleased",be=Symbol("elFocusTrap"),H=g(),P=g(0),$=g(0);let b=0;const oe=e=>{const n=[],t=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const r=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||r?NodeFilter.FILTER_SKIP:s.tabIndex>=0||s===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)n.push(t.currentNode);return n},J=(e,n)=>{for(const t of e)if(!_e(t,n))return t},_e=(e,n)=>{if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(n&&e===n)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1},Se=e=>{const n=oe(e),t=J(n,e),s=J(n.reverse(),e);return[t,s]},ge=e=>e instanceof HTMLInputElement&&"select"in e,p=(e,n)=>{if(e){const t=document.activeElement;Ee(e,{preventScroll:!0}),$.value=window.performance.now(),e!==t&&ge(e)&&n&&e.select()}};function Y(e,n){const t=[...e],s=e.indexOf(n);return s!==-1&&t.splice(s,1),t}const Pe=()=>{let e=[];return{push:s=>{const r=e[0];r&&s!==r&&r.pause(),e=Y(e,s),e.unshift(s)},remove:s=>{var r,a;e=Y(e,s),(a=(r=e[0])==null?void 0:r.resume)==null||a.call(r)}}},Ce=(e,n=!1)=>{const t=document.activeElement;for(const s of e)if(p(s,n),document.activeElement!==t)return},G=Pe(),Le=()=>P.value>$.value,_=()=>{H.value="pointer",P.value=window.performance.now()},Q=()=>{H.value="keyboard",P.value=window.performance.now()},Oe=()=>(B(()=>{b===0&&(document.addEventListener("mousedown",_),document.addEventListener("touchstart",_),document.addEventListener("keydown",Q)),b++}),D(()=>{b--,b<=0&&(document.removeEventListener("mousedown",_),document.removeEventListener("touchstart",_),document.removeEventListener("keydown",Q))}),{focusReason:H,lastUserFocusTimestamp:P,lastAutomatedFocusTimestamp:$}),S=e=>new CustomEvent(ye,{...Fe,detail:e});let E=[];const X=e=>{te(e)===ne.esc&&E.forEach(t=>t(e))},ke=e=>{B(()=>{E.length===0&&document.addEventListener("keydown",X),m&&E.push(e)}),D(()=>{E=E.filter(n=>n!==e),E.length===0&&m&&document.removeEventListener("keydown",X)})},Re=Z({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[M,z,"focusin","focusout","focusout-prevented","release-requested"],setup(e,{emit:n}){const t=g();let s,r;const{focusReason:a}=Oe();ke(o=>{e.trapped&&!d.paused&&n("release-requested",o)});const d={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},v=o=>{if(!e.loop&&!e.trapped||d.paused)return;const{altKey:c,ctrlKey:u,metaKey:i,currentTarget:l,shiftKey:O}=o,{loop:x}=e,se=te(o)===ne.tab&&!c&&!u&&!i,w=document.activeElement;if(se&&w){const k=l,[R,N]=Se(k);if(R&&N){if(!O&&w===N){const f=S({focusReason:a.value});n("focusout-prevented",f),f.defaultPrevented||(o.preventDefault(),x&&p(R,!0))}else if(O&&[R,k].includes(w)){const f=S({focusReason:a.value});n("focusout-prevented",f),f.defaultPrevented||(o.preventDefault(),x&&p(N,!0))}}else if(w===k){const f=S({focusReason:a.value});n("focusout-prevented",f),f.defaultPrevented||o.preventDefault()}}};de(be,{focusTrapRef:t,onKeydown:v}),I(()=>e.focusTrapEl,o=>{o&&(t.value=o)},{immediate:!0}),I([t],([o],[c])=>{o&&(o.addEventListener("keydown",v),o.addEventListener("focusin",C),o.addEventListener("focusout",L)),c&&(c.removeEventListener("keydown",v),c.removeEventListener("focusin",C),c.removeEventListener("focusout",L))});const T=o=>{n(M,o)},h=o=>n(z,o),C=o=>{const c=y(t);if(!c)return;const u=o.target,i=o.relatedTarget,l=u&&c.contains(u);e.trapped||i&&c.contains(i)||(s=i),l&&n("focusin",o),!d.paused&&e.trapped&&(l?r=u:p(r,!0))},L=o=>{const c=y(t);if(!(d.paused||!c))if(e.trapped){const u=o.relatedTarget;!fe(u)&&!c.contains(u)&&setTimeout(()=>{if(!d.paused&&e.trapped){const i=S({focusReason:a.value});n("focusout-prevented",i),i.defaultPrevented||p(r,!0)}},0)}else{const u=o.target;u&&c.contains(u)||n("focusout",o)}};async function V(){await j();const o=y(t);if(o){G.push(d);const c=o.contains(document.activeElement)?s:document.activeElement;if(s=c,!o.contains(c)){const i=new Event(A,q);o.addEventListener(A,T),o.dispatchEvent(i),i.defaultPrevented||j(()=>{let l=e.focusStartEl;pe(l)||(p(l),document.activeElement!==l&&(l="first")),l==="first"&&Ce(oe(o),!0),(document.activeElement===c||l==="container")&&p(o)})}}}function W(){const o=y(t);if(o){o.removeEventListener(A,T);const c=new CustomEvent(U,{...q,detail:{focusReason:a.value}});o.addEventListener(U,h),o.dispatchEvent(c),!c.defaultPrevented&&(a.value=="keyboard"||!Le()||o.contains(document.activeElement))&&p(s!=null?s:document.body),o.removeEventListener(U,h),G.remove(d),s=null,r=null}}return B(()=>{e.trapped&&V(),I(()=>e.trapped,o=>{o?V():W()})}),D(()=>{e.trapped&&W(),t.value&&(t.value.removeEventListener("keydown",v),t.value.removeEventListener("focusin",C),t.value.removeEventListener("focusout",L),t.value=void 0),s=null,r=null}),{onKeydown:v}}});function Ne(e,n,t,s,r,a){return K(e.$slots,"default",{handleKeydown:e.onKeydown})}var xe=ee(Re,[["render",Ne],["__file","/home/runner/work/element-plus/element-plus/packages/components/focus-trap/src/focus-trap.vue"]]);export{xe as E,He as a,$e as b,Ve as g,We as s,me as t};

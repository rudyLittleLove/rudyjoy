import{d as J,j as K,c as k,b as Q,w as $,F as V,r as D,o as B,f as W,a as F,V as L}from"./index.b16c7db2.js";import{E as X}from"./el-progress.8167d613.js";import{E as Y}from"./el-button.553af998.js";import{_ as Z}from"./plugin-vue_export-helper.21dcd24c.js";import"./index.78b0e0f0.js";import"./index.9952b6e6.js";import"./typescript.35cbd032.js";import"./use-form-common-props.4cfadbea.js";import"./_baseClone.ee7beaf3.js";import"./index.0944410b.js";import"./index.5468843d.js";import"./icon.14bc0150.js";if(!M)var M={map:function(i,o){var r={};return o?i.map(function(f,u){return r.index=u,o.call(r,f)}):i.slice()},naturalOrder:function(i,o){return i<o?-1:i>o?1:0},sum:function(i,o){var r={};return i.reduce(o?function(f,u,a){return r.index=a,f+o.call(r,u)}:function(f,u){return f+u},0)},max:function(i,o){return Math.max.apply(null,o?M.map(i,o):i)}};var tt=function(){var i=5,o=8-i,r=1e3,f=.75;function u(e,t,c){return(e<<2*i)+(t<<i)+c}function a(e){var t=[],c=!1;function p(){t.sort(e),c=!0}return{push:function(n){t.push(n),c=!1},peek:function(n){return c||p(),n===void 0&&(n=t.length-1),t[n]},pop:function(){return c||p(),t.pop()},size:function(){return t.length},map:function(n){return t.map(n)},debug:function(){return c||p(),t}}}function s(e,t,c,p,n,h,v){var d=this;d.r1=e,d.r2=t,d.g1=c,d.g2=p,d.b1=n,d.b2=h,d.histo=v}s.prototype={volume:function(e){var t=this;return(!t._volume||e)&&(t._volume=(t.r2-t.r1+1)*(t.g2-t.g1+1)*(t.b2-t.b1+1)),t._volume},count:function(e){var t=this,c=t.histo;if(!t._count_set||e){var p=0,n,h,v,d;for(n=t.r1;n<=t.r2;n++)for(h=t.g1;h<=t.g2;h++)for(v=t.b1;v<=t.b2;v++)d=u(n,h,v),p+=c[d]||0;t._count=p,t._count_set=!0}return t._count},copy:function(){var e=this;return new s(e.r1,e.r2,e.g1,e.g2,e.b1,e.b2,e.histo)},avg:function(e){var t=this,c=t.histo;if(!t._avg||e){var p=0,n=1<<8-i,h=0,v=0,d=0,y,l,g,_,A;for(l=t.r1;l<=t.r2;l++)for(g=t.g1;g<=t.g2;g++)for(_=t.b1;_<=t.b2;_++)A=u(l,g,_),y=c[A]||0,p+=y,h+=y*(l+.5)*n,v+=y*(g+.5)*n,d+=y*(_+.5)*n;p?t._avg=[~~(h/p),~~(v/p),~~(d/p)]:t._avg=[~~(n*(t.r1+t.r2+1)/2),~~(n*(t.g1+t.g2+1)/2),~~(n*(t.b1+t.b2+1)/2)]}return t._avg},contains:function(e){var t=this,c=e[0]>>o;return gval=e[1]>>o,bval=e[2]>>o,c>=t.r1&&c<=t.r2&&gval>=t.g1&&gval<=t.g2&&bval>=t.b1&&bval<=t.b2}};function b(){this.vboxes=new a(function(e,t){return M.naturalOrder(e.vbox.count()*e.vbox.volume(),t.vbox.count()*t.vbox.volume())})}b.prototype={push:function(e){this.vboxes.push({vbox:e,color:e.avg()})},palette:function(){return this.vboxes.map(function(e){return e.color})},size:function(){return this.vboxes.size()},map:function(e){for(var t=this.vboxes,c=0;c<t.size();c++)if(t.peek(c).vbox.contains(e))return t.peek(c).color;return this.nearest(e)},nearest:function(e){for(var t=this.vboxes,c,p,n,h=0;h<t.size();h++)p=Math.sqrt(Math.pow(e[0]-t.peek(h).color[0],2)+Math.pow(e[1]-t.peek(h).color[1],2)+Math.pow(e[2]-t.peek(h).color[2],2)),(p<c||c===void 0)&&(c=p,n=t.peek(h).color);return n},forcebw:function(){var e=this.vboxes;e.sort(function(n,h){return M.naturalOrder(M.sum(n.color),M.sum(h.color))});var t=e[0].color;t[0]<5&&t[1]<5&&t[2]<5&&(e[0].color=[0,0,0]);var c=e.length-1,p=e[c].color;p[0]>251&&p[1]>251&&p[2]>251&&(e[c].color=[255,255,255])}};function w(e){var t=1<<3*i,c=new Array(t),p,n,h,v;return e.forEach(function(d){n=d[0]>>o,h=d[1]>>o,v=d[2]>>o,p=u(n,h,v),c[p]=(c[p]||0)+1}),c}function m(e,t){var c=1e6,p=0,n=1e6,h=0,v=1e6,d=0,y,l,g;return e.forEach(function(_){y=_[0]>>o,l=_[1]>>o,g=_[2]>>o,y<c?c=y:y>p&&(p=y),l<n?n=l:l>h&&(h=l),g<v?v=g:g>d&&(d=g)}),new s(c,p,n,h,v,d,t)}function j(e,t){if(!t.count())return;var c=t.r2-t.r1+1,p=t.g2-t.g1+1,n=t.b2-t.b1+1,h=M.max([c,p,n]);if(t.count()==1)return[t.copy()];var v=0,d=[],y=[],l,g,_,A,C;if(h==c)for(l=t.r1;l<=t.r2;l++){for(A=0,g=t.g1;g<=t.g2;g++)for(_=t.b1;_<=t.b2;_++)C=u(l,g,_),A+=e[C]||0;v+=A,d[l]=v}else if(h==p)for(l=t.g1;l<=t.g2;l++){for(A=0,g=t.r1;g<=t.r2;g++)for(_=t.b1;_<=t.b2;_++)C=u(g,l,_),A+=e[C]||0;v+=A,d[l]=v}else for(l=t.b1;l<=t.b2;l++){for(A=0,g=t.r1;g<=t.r2;g++)for(_=t.g1;_<=t.g2;_++)C=u(g,_,l),A+=e[C]||0;v+=A,d[l]=v}d.forEach(function(O,x){y[x]=v-O});function I(O){var x=O+"1",P=O+"2",q,N,T,S,E,U=0;for(l=t[x];l<=t[P];l++)if(d[l]>v/2){for(T=t.copy(),S=t.copy(),q=l-t[x],N=t[P]-l,q<=N?E=Math.min(t[P]-1,~~(l+N/2)):E=Math.max(t[x],~~(l-1-q/2));!d[E];)E++;for(U=y[E];!U&&d[E-1];)U=y[--E];return T[P]=E,S[x]=T[P]+1,[T,S]}}return h==c?I("r"):h==p?I("g"):I("b")}function z(e,t){if(!e.length||t<2||t>256)return!1;var c=w(e);c.forEach(function(){});var p=m(e,c),n=new a(function(y,l){return M.naturalOrder(y.count(),l.count())});n.push(p);function h(y,l){for(var g=y.size(),_=0,A;_<r;){if(g>=l||_++>r)return;if(A=y.pop(),!A.count()){y.push(A),_++;continue}var C=j(c,A),I=C[0],O=C[1];if(!I)return;y.push(I),O&&(y.push(O),g++)}}h(n,f*t);for(var v=new a(function(y,l){return M.naturalOrder(y.count()*y.volume(),l.count()*l.volume())});n.size();)v.push(n.pop());h(v,t);for(var d=new b;v.size();)d.push(v.pop());return d}return{quantize:z}}(),rt=tt.quantize;function et(i){for(var o=new Array(i),r=0;r<i;++r)o[r]=r;return o}var nt=et;/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var ot=function(i){return i!=null&&(G(i)||it(i)||!!i._isBuffer)};function G(i){return!!i.constructor&&typeof i.constructor.isBuffer=="function"&&i.constructor.isBuffer(i)}function it(i){return typeof i.readFloatLE=="function"&&typeof i.slice=="function"&&G(i.slice(0,0))}var ut=nt,at=ot,st=typeof Float64Array!="undefined";function ct(i,o){return i[0]-o[0]}function ft(){var i=this.stride,o=new Array(i.length),r;for(r=0;r<o.length;++r)o[r]=[Math.abs(i[r]),r];o.sort(ct);var f=new Array(o.length);for(r=0;r<f.length;++r)f[r]=o[r][1];return f}function pt(i,o){var r=["View",o,"d",i].join("");o<0&&(r="View_Nil"+i);var f=i==="generic";if(o===-1){var u="function "+r+"(a){this.data=a;};var proto="+r+".prototype;proto.dtype='"+i+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+r+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+r+"(a){return new "+r+"(a);}",p=new Function(u);return p()}else if(o===0){var u="function "+r+"(a,d) {this.data = a;this.offset = d};var proto="+r+".prototype;proto.dtype='"+i+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+r+"_copy() {return new "+r+"(this.data,this.offset)};proto.pick=function "+r+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+r+"_get(){return "+(f?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+r+"_set(v){return "+(f?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+r+"(a,b,c,d){return new "+r+"(a,d)}",p=new Function("TrivialArray",u);return p(R[i][0])}var u=["'use strict'"],a=ut(o),s=a.map(function(n){return"i"+n}),b="this.offset+"+a.map(function(n){return"this.stride["+n+"]*i"+n}).join("+"),w=a.map(function(n){return"b"+n}).join(","),m=a.map(function(n){return"c"+n}).join(",");u.push("function "+r+"(a,"+w+","+m+",d){this.data=a","this.shape=["+w+"]","this.stride=["+m+"]","this.offset=d|0}","var proto="+r+".prototype","proto.dtype='"+i+"'","proto.dimension="+o),u.push("Object.defineProperty(proto,'size',{get:function "+r+"_size(){return "+a.map(function(n){return"this.shape["+n+"]"}).join("*"),"}})"),o===1?u.push("proto.order=[0]"):(u.push("Object.defineProperty(proto,'order',{get:"),o<4?(u.push("function "+r+"_order(){"),o===2?u.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):o===3&&u.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):u.push("ORDER})")),u.push("proto.set=function "+r+"_set("+s.join(",")+",v){"),f?u.push("return this.data.set("+b+",v)}"):u.push("return this.data["+b+"]=v}"),u.push("proto.get=function "+r+"_get("+s.join(",")+"){"),f?u.push("return this.data.get("+b+")}"):u.push("return this.data["+b+"]}"),u.push("proto.index=function "+r+"_index(",s.join(),"){return "+b+"}"),u.push("proto.hi=function "+r+"_hi("+s.join(",")+"){return new "+r+"(this.data,"+a.map(function(n){return["(typeof i",n,"!=='number'||i",n,"<0)?this.shape[",n,"]:i",n,"|0"].join("")}).join(",")+","+a.map(function(n){return"this.stride["+n+"]"}).join(",")+",this.offset)}");var j=a.map(function(n){return"a"+n+"=this.shape["+n+"]"}),z=a.map(function(n){return"c"+n+"=this.stride["+n+"]"});u.push("proto.lo=function "+r+"_lo("+s.join(",")+"){var b=this.offset,d=0,"+j.join(",")+","+z.join(","));for(var e=0;e<o;++e)u.push("if(typeof i"+e+"==='number'&&i"+e+">=0){d=i"+e+"|0;b+=c"+e+"*d;a"+e+"-=d}");u.push("return new "+r+"(this.data,"+a.map(function(n){return"a"+n}).join(",")+","+a.map(function(n){return"c"+n}).join(",")+",b)}"),u.push("proto.step=function "+r+"_step("+s.join(",")+"){var "+a.map(function(n){return"a"+n+"=this.shape["+n+"]"}).join(",")+","+a.map(function(n){return"b"+n+"=this.stride["+n+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var e=0;e<o;++e)u.push("if(typeof i"+e+"==='number'){d=i"+e+"|0;if(d<0){c+=b"+e+"*(a"+e+"-1);a"+e+"=ceil(-a"+e+"/d)}else{a"+e+"=ceil(a"+e+"/d)}b"+e+"*=d}");u.push("return new "+r+"(this.data,"+a.map(function(n){return"a"+n}).join(",")+","+a.map(function(n){return"b"+n}).join(",")+",c)}");for(var t=new Array(o),c=new Array(o),e=0;e<o;++e)t[e]="a[i"+e+"]",c[e]="b[i"+e+"]";u.push("proto.transpose=function "+r+"_transpose("+s+"){"+s.map(function(n,h){return n+"=("+n+"===undefined?"+h+":"+n+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+r+"(this.data,"+t.join(",")+","+c.join(",")+",this.offset)}"),u.push("proto.pick=function "+r+"_pick("+s+"){var a=[],b=[],c=this.offset");for(var e=0;e<o;++e)u.push("if(typeof i"+e+"==='number'&&i"+e+">=0){c=(c+this.stride["+e+"]*i"+e+")|0}else{a.push(this.shape["+e+"]);b.push(this.stride["+e+"])}");u.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),u.push("return function construct_"+r+"(data,shape,stride,offset){return new "+r+"(data,"+a.map(function(n){return"shape["+n+"]"}).join(",")+","+a.map(function(n){return"stride["+n+"]"}).join(",")+",offset)}");var p=new Function("CTOR_LIST","ORDER",u.join(`
`));return p(R[i],ft)}function lt(i){if(at(i))return"buffer";if(st)switch(Object.prototype.toString.call(i)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(i)?"array":"generic"}var R={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};function ht(i,o,r,f){if(i===void 0){var m=R.array[0];return m([])}else typeof i=="number"&&(i=[i]);o===void 0&&(o=[i.length]);var u=o.length;if(r===void 0){r=new Array(u);for(var a=u-1,s=1;a>=0;--a)r[a]=s,s*=o[a]}if(f===void 0){f=0;for(var a=0;a<u;++a)r[a]<0&&(f-=(o[a]-1)*r[a])}for(var b=lt(i),w=R[b];w.length<=u+1;)w.push(pt(b,w.length-1));var m=w[u+1];return m(i,o,r,f)}var dt=ht;function vt(i,o,r){const f=i,u=[];for(let a=0,s,b,w,m,j;a<o;a=a+r)s=a*4,b=f[s+0],w=f[s+1],m=f[s+2],j=f[s+3],(typeof j=="undefined"||j>=125)&&(b>250&&w>250&&m>250||u.push([b,w,m]));return u}function gt(i){let{colorCount:o,quality:r}=i;if(typeof o=="undefined"||!Number.isInteger(o))o=10;else{if(o===1)throw new Error("colorCount should be between 2 and 20. To get one color, call getColor() instead of getPalette()");o=Math.max(o,2),o=Math.min(o,20)}return(typeof r=="undefined"||!Number.isInteger(r)||r<1)&&(r=10),{colorCount:o,quality:r}}function mt(i){return new Promise((o,r)=>{yt(i,function(f,u){f?r(f):o(u)})})}function yt(i,o){var r=new Image;r.crossOrigin="Anonymous",r.onload=function(){var f=document.createElement("canvas");f.width=r.width,f.height=r.height;var u=f.getContext("2d");u.drawImage(r,0,0);var a=u.getImageData(0,0,r.width,r.height);o(null,dt(new Uint8Array(a.data),[r.width,r.height,4],[4,4*r.width,1],0))},r.onerror=function(f){o(f)},r.src=i}function _t(i,o){return new Promise((r,f)=>{H(i,5,o).then(u=>{r(u[0])}).catch(u=>{f(u)})})}function H(i,o=10,r=10){const f=gt({colorCount:o,quality:r});return new Promise((u,a)=>{mt(i).then(s=>{const b=s.shape[0]*s.shape[1],w=vt(s.data,b,f.quality),m=rt(w,f.colorCount),j=m?m.palette():null;u(j)}).catch(s=>{a(s)})})}const bt={class:"wrapper"},wt=["src"],At=J({__name:"index",setup(i){const o=K([]),r=(a,s)=>{let b=new FileReader;b.readAsDataURL(a.raw),b.onload=w=>{_t(w.target.result).then(m=>{a.color=`rgb(${m.join(",")})`,f(a,s)}),H(w.target.result,6).then(m=>{a.colors=m.map(j=>`rgb(${j.join(",")})`),f(a,s)}),H(w.target.result,18).then(m=>{a.colors18=m.map(j=>`rgb(${j.join(",")})`),f(a,s)})}},f=(a,s)=>{a.color&&a.colors&&a.colors18&&(o.value=[...s])},u=(a,s)=>{o.value=s};return(a,s)=>{const b=Y,w=X;return B(),k("div",bt,[Q(w,{class:"upload-demo",ref:"upload",action:"","list-type":"picture-card","file-list":o.value,"auto-upload":!1,"on-change":r,"on-remove":u},{trigger:$(()=>[Q(b,{type:"primary"},{default:$(()=>[...s[0]||(s[0]=[W("\u9009\u62E9\u56FE\u7247",-1)])]),_:1})]),tip:$(()=>[...s[1]||(s[1]=[F("div",{class:"el-upload__tip"},"\u53EA\u80FD\u9009\u62E9jpg/png\u6587\u4EF6",-1)])]),_:1},8,["file-list"]),(B(!0),k(V,null,D(o.value,(m,j)=>(B(),k("ul",{class:"img-item",key:j},[F("img",{src:m.url},null,8,wt),s[2]||(s[2]=F("h4",null,"getColor(url)",-1)),F("div",{class:"rect",style:L(`background-color: ${m.color}`)},null,4),s[3]||(s[3]=F("h4",null,"getPalette(url, 6)",-1)),(B(!0),k(V,null,D(m.colors,(z,e)=>(B(),k("div",{class:"rect",key:Math.random(),style:L(`background-color: ${z}`)},null,4))),128)),s[4]||(s[4]=F("h4",null,"getPalette(url, 18)",-1)),(B(!0),k(V,null,D(m.colors18,(z,e)=>(B(),k("div",{class:"rect",key:Math.random(),style:L(`background-color: ${z}`)},null,4))),128))]))),128))])}}});var Tt=Z(At,[["__scopeId","data-v-f4895e7a"]]);export{Tt as default};
